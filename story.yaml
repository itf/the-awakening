#############
# There are 2 types of structures: TEXT and WORDS
# WORDS are clickable.
# TEXT contain words.
#
# FLAGS:
# When you click on a WORD, it might set a flag, that can be used for conditionals.
# For convenience, the keyword of the text substitution is automatically added as a flag 
# whose value increase by 1 for every turn the text is present. It is removes as soon as the text is not displayed any longer.
#
# TEXT-KEYWORDS:
# You have access to the keywords of the texts that are being displayed, which can be used to modify the behavior of the WORDS.
# 
###############

begin:
    text: $start$

rooftop-start:
    text: You are on a [rooftop-rft-1]. $rooftop_state$
    
rooftop-any:
    text: It's a [rooftop-rft-2] like [any_other-rft]. $rooftop_characteristics$

rooftop-any-other:
    text: You've been to too many rooftops to care about them anymore.
    
rooftop-dark-state:
    text: It's [dark-rft].
    
rooftop-shadows-state:
    text: Shadows are dancing in the distance.
    text-flags: 
        - rooftop-shadows: 1

rooftop-night:
    text: It's [night-rft] on the [rooftop-rft-2]. $sky_state$
    
rooftop-dark-night:
    text: The [sky-rft-sky] is [dark-rft-sky].
    
rooftop-beautiful-night:
    text: You see the [beautiful-rft-sky] night [sky-rft-sky].

################################
# Words describing the rooftop
rooftop-rft-1:
    word: rooftop
    click:
        - condition: 
            flags:
                - investigate-rooftop
          substitutions:
            start: rooftop-any
          flags: 
            - investigate-rooftop: 1
        - condition: 
          flags: 
            - investigate-rooftop: 1
          substitutions:
            rooftop_state: rooftop-dark-state
              
rooftop-rft-2:
    word: rooftop
    click:
        - condition:
          flags: 
          substitutions:
            start: rooftop-start
          remove-flags: 

dark-rft:
    word: dark
    click:
          - condition: 
              flags:
                - investigate-rooftop
                - dark-rooftop
                - dark-sky
            substitutions:
              rooftop_state: rooftop-shadows-state
          - substitutions:
                start: rooftop-night
            flags:  
                - dark-rooftop

any_other-rft:
    word: any other
    click:
        - condition:
            not_flags: 
                - any-other-rooftop
          substitutions:
            rooftop_characteristics: rooftop-any-other
          flags: 
            - any-other-rooftop

############
# Sky at the rooftop
night-rft:
    word: night
    click:
        - substitutions:
            sky_state: rooftop-dark-night


sky-rft-sky:
    word: sky
    click:
        - substitutions:
            sky_state: rooftop-beautiful-night
    
dark-rft-sky:
    word: dark
    click:
        - substitutions:
          flags: 
            - dark-sky
          body_class: 
            - flash-dark
          remove_flags:
            - beautiful-sky
beautiful-rft-sky:
    word: beautiful
    click:
        - substitutions: 
          remove_flags:
            - dark-sky
          flags: beautiful-sky